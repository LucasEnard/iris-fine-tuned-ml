do $SYSTEM.SQL.Execute("LOAD DATA FROM FILE /irisdev/app/misc/dataset.csv INTO iris.Review")
do $SYSTEM.SQL.Execute("LOAD DATA FROM FILE /irisdev/ap INTO iris.Review")


SET result=$SYSTEM.SQL.Execute("LOAD DATA FROM FILE '/irisdev/app/misc/dataset/dataset.txt' INTO iris.Review USING '{'from' : {'file' : {'columnseparator' : ';'}}}' ")
SET result=$SYSTEM.SQL.Execute("LOAD DATA FROM FILE '/irisdev/app/misc/dataset/dataset.txt' INTO iris.Review")
DO result.%Display()


DO ##class(community.csvgen).Generate("/irisdev/app/misc/dataset/dataset.txt",";","iris.Review")
DO ##class(community.csvgen).Generate("/irisdev/app/misc/dataset/dataset1.txt",";","iris.Review")
DO ##class(community.csvgen).Generate("/irisdev/app/misc/dataset/dataset2.txt",";","iris.Review")
DO ##class(community.csvgen).Generate("/irisdev/app/misc/dataset/dataset3.txt",";","iris.Review")
DO ##class(community.csvgen).Generate("/irisdev/app/misc/dataset/dataset4.txt",";","iris.Review")
DO ##class(community.csvgen).Generate("/irisdev/app/misc/dataset/dataset5.txt",";","iris.Review")
DO ##class(community.csvgen).Generate("/irisdev/app/misc/dataset/dataset6.txt",";","iris.Review")
DO ##class(community.csvgen).Generate("/irisdev/app/misc/dataset/dataset7.txt",";","iris.Review")
DO ##class(community.csvgen).Generate("/irisdev/app/misc/dataset/dataset8.txt",";","iris.Review")
DO ##class(community.csvgen).Generate("/irisdev/app/misc/dataset/dataset9.txt",";","iris.Review")
DO ##class(community.csvgen).Generate("/irisdev/app/misc/dataset/dataset10.txt",";","iris.Review")


DO ##class(community.csvgen).Generate("/irisdev/app/misc/dataset/datasets/dataset1.txt",";","iris.Review")
DO ##class(community.csvgen).Generate("/irisdev/app/misc/dataset/datasets/dataset2.txt",";","iris.Review")
DO ##class(community.csvgen).Generate("/irisdev/app/misc/dataset/datasets/dataset3.txt",";","iris.Review")
DO ##class(community.csvgen).Generate("/irisdev/app/misc/dataset/datasets/dataset4.txt",";","iris.Review")
DO ##class(community.csvgen).Generate("/irisdev/app/misc/dataset/datasets/dataset1.txt",";","iris.Review")
DO ##class(community.csvgen).Generate("/irisdev/app/misc/dataset/datasets/dataset1.txt",";","iris.Review")
DO ##class(community.csvgen).Generate("/irisdev/app/misc/dataset/datasets/dataset20.txt",";","iris.Review")


do sc.%Display()

d ##class(community.csvgen).GenerateFromURL("https://raw.githubusercontent.com/datasciencedojo/datasets/master/titanic.csv",",","Data.Titanic")



SET result= ##class(%SQL.Util.Procedures).CSVTOCLASS()
DO result.%Display()

do ##class(%SQL.Util.Procedures).CSVTOCLASS(1, "ReviewLabel VARCHAR(250), ReviewText VARCHAR(3000000)", "/irisdev/app/misc/dataset/datasets/dataset.txt", ";", ,1, "iris.Review")

#TEST

"LOAD DATA FROM FILE '"_fncsv_"' COLUMNS("_prowtype_") INTO pclass USING {""from"":{""file"":{""columnseparator"":"""_dlm_""",""header"":""1""}}}"
"LOAD DATA FROM FILE '"/irisdev/app/misc/dataset/datasets/dataset.txt"' COLUMNS("ReviewLabel VARCHAR(250), ReviewText VARCHAR(3000000)") INTO iris.Review USING {""from"":{""file"":{""columnseparator"":""";""",""header"":""1""}}}"

SET result=$SYSTEM.SQL.Execute("LOAD DATA FROM FILE '"/irisdev/app/misc/dataset/datasets/dataset.txt"' COLUMNS(ReviewLabel, ReviewText) INTO iris.Review USING {""from"":{""file"":{""columnseparator"":"";"",""header"":""1""}}}")
DO result.%Display()

set importsql = "LOAD DATA FROM FILE '"/irisdev/app/misc/dataset/datasets/dataset.txt"' COLUMNS(ReviewLabel, ReviewText) INTO iris.Review USING {""from"":{""file"":{""columnseparator"":"";"",""header"":""1""}}}"
set sc = ##class(%SQL.Statement).%New().%Prepare(importsql)



set fncsv="/irisdev/app/misc/dataset/datasets/dataset1.txt"
set prowtype="ReviewLabel VARCHAR, ReviewText VARCHAR"
set tablename="iris.Review"
set dlm=";"

set importsql="LOAD DATA FROM FILE '"_fncsv_"'"
set importsql=importsql_" COLUMNS("_prowtype_") INTO "_tablename
set importsql=importsql_" USING {""from"":{""file"":{""columnseparator"":"""_dlm_""""
set importsql=importsql_",""header"":""1"""
set importsql=importsql_"}}}"
set tStatement = ##class(%SQL.Statement).%New()
set sc = tStatement.%Prepare(importsql)
SET rset = tStatement.%Execute()
DO rset.%Display()


set fncsv="/irisdev/app/misc/dataset/datasets/dataset.txt"
set tablename="iris.Review"
set dlm=";"

set importsql="LOAD DATA FROM FILE '"_fncsv_"'"_" INTO "_tablename_" USING {""from"":{""file"":{""columnseparator"":"""_dlm_""""_",""header"":""1"""_"}}}"
set tStatement = ##class(%SQL.Statement).%New()
set sc = tStatement.%Prepare(importsql)
SET rset = tStatement.%Execute()
DO rset.%Display()
